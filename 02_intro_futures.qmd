---
title: Pricing and Hedging Derivative Securities
subtitle: Introduction to Futures

format:
  revealjs:
    theme: custom-dark.scss
    transition: slide
    slide-number: true
    chalkboard: true
    incremental: false
    fig-width: 10
    fig-height: 5
execute:
  echo: false
jupyter: python3
engine: jupyter
---

```{python}
#| echo: false

import numpy as np
import pandas as pd
import plotly.graph_objects as go
import plotly.express as px
from plotly.subplots import make_subplots
from dateutil.relativedelta import relativedelta
from IPython.display import display, HTML
import plotly
plotly.offline.init_notebook_mode(connected=True)
```


## What Are Futures Contracts? {data-state="grid-medium"}

**Futures contracts** are standardized agreements to deliver an asset at a future date in exchange for payment at that date.

::: {.incremental}

- **Futures price**: Price at which a contract trades.  The price is paid at delivery.
- **Delivery**: Asset exchanged at expiration
- **Payment**: Made at delivery, not when contract is traded
- Both buyer and seller have obligations (unlike options!)
:::

## Futures vs. Options {data-state="grid-coarse"}

::::  {.columns}
::: {.column width="50%"}
**Futures Contracts**

- Both parties have obligations
- Both must post margin
- No upfront payment
- Symmetrical payoff
- Daily settlement
:::

::: {.column width="50%"}
**Options Contracts**

- Only seller has obligation
- Only seller posts margin
- Buyer pays premium upfront
- Asymmetric payoff
- Settlement at expiration
:::
::::

## Historical Context {data-state="grid-medium"}

Futures have a long history in commodity markets:

::: {.incremental}

- **1851**: Modern futures trading begins in the United States
- **1981**: Cash-settled contracts introduced
- **Today**: Futures on commodities, financial assets, indices, currencies, and more

**Cash-settled contracts**: No physical delivery - settled based on underlying value at expiration
:::

## Long and Short Positions {data-state="grid-sparse"}

::: {.incremental}

**Long (Buyer):** Obligation to accept delivery, profits when price rises

**Short (Seller):** Obligation to deliver, profits when price falls
:::

## Example: Trading Corn Futures {data-state="grid-medium"}

Farmer sells futures at $5.00/bushel, spot later drops to $4.00:

::: {.incremental}

**Physical Delivery:** Deliver corn, receive $5.00/bushel

**Offset Position:**

- Buy futures at $4.00 → Profit = $1.00/bushel
- Sell corn in spot market at $4.00
- **Total: $5.00/bushel** (same result!)

**Key insight:** Spot-futures convergence at expiration
:::

## Contract Specifications {data-state="grid-fine"}

Exchanges standardize all contract terms:

::: {.incremental}

- **Delivery location** and **date**
- **Quantity** and **quality** (with price adjustments)

**Example**: [CME Corn Futures](https://www.cmegroup.com/markets/agriculture/grains/corn.contractSpecs.html)
- 5,000 bushels per contract, Illinois delivery locations
:::

## Cash-Settled Futures {data-state="grid-medium"}

No physical delivery - settled based on index value:

::: {.incremental}

**E-mini S&P 500:** $50 multiplier per index point

- Buy at 6000, index expires at 6500
- Profit = $50 × 500 = **$25,000**

**Benefits:** Eliminates delivery logistics, enables index futures
:::

## Trading vs. Gambling {data-state="grid-coarse"}

**Key distinction**: Futures must serve **legitimate risk-management needs**

::: {.incremental}

**Examples:**

- Fund manager hedging equity portfolio
- Airline hedging fuel costs
- Utility hedging temperature risk
:::

## Market Structure {data-state="grid-fine"}

Like options, futures have:

::: {.incremental}

- **Exchange-traded**: Standardized, transparent
- **Clearinghouse**: Central counterparty
- **Open interest**: Long = short positions
- **Most positions closed early** via offsetting trades
:::

## Margin and Marking to Market {data-state="grid-medium"}

**Daily Settlement Process:**

::: {.incremental}

- Exchange sets settlement price each day
- All positions marked to this price
- Profits/losses immediately transferred
- Virtually eliminates counterparty risk
:::

## Daily Settlement Example {data-state="grid-sparse"}

Buy 1 e-mini S&P 500 contract at 6000:

| Day | Settlement Price | Daily P/L | Cumulative P/L |
|-----|-----------------|-----------|----------------|
| 0 (Entry) | 6000 | - | - |
| 1 | 6010 | +$500 | +$500 |
| 2 | 5990 | -$1,000 | -$500 |
| 3 | 6020 | +$1,500 | +$1,000 |

Day 3: Close position, walk away with $1,000 gain

Calculation: (6020 - 6000) × $50 = $1,000

## Margin Requirements {data-state="grid-coarse"}

Two types of margin:

::::  {.columns}
::: {.column width="50%"}
**Initial Margin**

- Required to open position
- Typically 3-12% of contract value
- Set by exchange
:::

::: {.column width="50%"}
**Maintenance Margin**

- Minimum to keep position open
- Lower than initial margin
- If breached → margin call
:::
::::

::: {.fragment}
**Margin Call**: Demand for additional margin to restore account to initial margin level. Failure to meet = forced liquidation.
:::

## Leverage in Futures {data-state="grid-medium"}

**10% margin = 10:1 leverage**

::: {.incremental}

- 1% price move = 10% gain/loss on margin
- 10% price move = 100% gain/loss on margin

**Safety mechanisms:** Daily marking to market + margin calls + clearinghouse
:::

## The Expectations Hypothesis {data-state="grid-medium"}

**Futures prices = Expected future spot prices**

::: {.incremental}

**Logic:** If $F \neq E[S_T]$, trading for expected profit drives $F \to E[S_T]$

**Problem:** Assumes risk-neutral investors!
:::

## Reality: Risk Premia {data-state="grid-sparse"}

::: {.incremental}

**Risk-averse investors** won't trade unlimited amounts

**Result:** Futures prices can deviate from expected spot prices

- Deviation depends on covariance with market risk
- From CAPM: covariance with market return

**Despite this:** Expectations still prime determinant of prices
:::

## Spot-Futures Parity {data-state="grid-medium"}

Unlike expectations hypothesis, parity is an **arbitrage relationship**:

$$F = \mathrm{e}^{(c-y)T}S$$

where:

- $F$ = futures price
- $S$ = current spot price
- $c$ = cost of carry (continuously compounded)
- $y$ = convenience yield (continuously compounded)
- $T$ = time to expiration

## Cost of Carry and Convenience Yield {data-state="grid-coarse"}

::::  {.columns}
::: {.column width="50%"}
**Cost of Carry ($c$)**

- Foregone interest on capital
- Storage costs (commodities)
- No costs for holding futures

**For financial assets:** $c = r$
:::

::: {.column width="50%"}
**Convenience Yield ($y$)**

- Dividends/cash flows
- Benefits of physical possession
- Never negative

**For financial assets:** $y$ = dividend yield
:::
::::

## Arbitrage: Buy Spot, Sell Futures {data-state="grid-medium"}

If $F > \mathrm{e}^{rT}S$ (assuming $c=r$, $y=0$):

::: {.incremental}

1. Borrow $S$, buy spot asset
2. Sell futures at $F$
3. At expiration: deliver asset, receive $F$, repay $\mathrm{e}^{rT}S$

**Profit**: $F - \mathrm{e}^{rT}S$ (risk-free!)
:::

## Arbitrage: Sell Spot, Buy Futures {data-state="grid-medium"}

If $F < \mathrm{e}^{rT}S$ (assuming $c=r$, $y=0$):

::: {.incremental}

1. Short sell spot asset for $S$, invest proceeds
2. Buy futures at $F$
3. At expiration: pay $F$, accept delivery, return to lender

**Profit**: $\mathrm{e}^{rT}S - F$ (risk-free!)
:::

## Why Parity Holds {data-state="grid-sparse"}

::: {.incremental}

**Institutional arbitrageurs** exploit violations quickly

**Extensions:**

- Storage costs → add to $c$
- Dividends → subtract from $c$ (or add to $y$)
- General formula: $F = \mathrm{e}^{(c-y)T}S$
:::

## Forward Curves {data-state="grid-medium"}

**Forward curve**: Relationship between futures price and contract maturity

From spot-futures parity:

$$F = \mathrm{e}^{(c-y)T}S$$

::: {.incremental}

**Shape depends on $c - y$:**

- If $c > y$: Upward sloping (contango)
- If $c < y$: Downward sloping (backwardation)
- If $c = y$: Flat
:::

## Gold Forward Curve {data-state="grid-none"}

Gold: negligible storage, no dividends, no convenience yield → $c - y = r$

```{python}
#| label: fig-gold-forward
#| fig-height: 500
#| echo: false

df = pd.read_csv('https://www.dropbox.com/s/832hth1es40f4g7/newfutures.csv?dl=1', index_col=0)
df = df[df.date>='2010-01-01']
df.date = pd.to_datetime(df.date)

def add_months_and_set_day(date, months_to_add):
    new_date = date + relativedelta(months=int(months_to_add))
    new_date = new_date.replace(day=15)
    return new_date

df['new_to_date'] = df.apply(
    lambda row: add_months_and_set_day(row['date'], row['months past front month']),
    axis=1
)
df = df.reset_index(drop=True).set_index(['code', 'date', 'new_to_date']).settle

gold = df.loc[('CME_GC', '2022-06-29')]

fig = go.Figure()
fig.add_trace(go.Scatter(x=gold.index, y=gold.values,
                        mode='lines+markers',
                        name='Gold Futures',
                        line=dict(color='gold', width=3),
                        hovertemplate='%{x|%b %Y}<br>Price: $%{y:.2f}<extra></extra>'))
fig.update_layout(
    title="Gold Forward Curve (2022-06-29)",
    xaxis_title="Maturity Date",
    yaxis_title="Futures Price ($)",
    template="plotly_white",
    height=500,
    showlegend=False
)
fig.show()
```

## Currency Forward Curves {data-state="grid-none"}

For currencies: $c - y = r - r_f$ (domestic vs. foreign interest rates)

```{python}
#| label: fig-currency-forwards
#| fig-height: 500
#| echo: false

yen = df.loc[('CME_JY', '2022-06-29')]
peso = df.loc[('CME_MP', '2022-06-29')]

fig = make_subplots(
    rows=1, cols=2,
    subplot_titles=('Japanese Yen: r > r_f', 'Mexican Peso: r < r_f'),
    horizontal_spacing=0.15
)

fig.add_trace(
    go.Scatter(x=yen.index, y=yen.values,
               mode='lines+markers',
               name='Japanese Yen',
               line=dict(width=3),
               hovertemplate='%{x|%b %Y}<br>Price: %{y:.6f}<extra></extra>'),
    row=1, col=1
)

fig.add_trace(
    go.Scatter(x=peso.index, y=peso.values,
               mode='lines+markers',
               name='Mexican Peso',
               line=dict(width=3),
               hovertemplate='%{x|%b %Y}<br>Price: %{y:.6f}<extra></extra>'),
    row=1, col=2
)

fig.update_xaxes(title_text="Maturity Date", row=1, col=1)
fig.update_xaxes(title_text="Maturity Date", row=1, col=2)
fig.update_yaxes(title_text="Futures Price", row=1, col=1)
fig.update_layout(
    height=500,
    showlegend=False,
    template='plotly_white'
)
fig.show()
```

## S&P 500 Forward Curve {data-state="grid-none"}

For stock indices: $c - y = r - \text{dividend yield}$

```{python}
#| label: fig-sp500-forward
#| fig-height: 500
#| echo: false

sp500 = df.loc[('CME_ES', '2020-06-01')]

fig = go.Figure()
fig.add_trace(go.Scatter(x=sp500.index, y=sp500.values,
                        mode='lines+markers',
                        name='S&P 500 Futures',
                        line=dict(width=3),
                        hovertemplate='%{x|%b %Y}<br>Price: %{y:.2f}<extra></extra>'))
fig.update_layout(
    title="S&P 500 Forward Curve (2020-06-01): Dividend Yield > Interest Rate",
    xaxis_title="Maturity Date",
    yaxis_title="Futures Price",
    template="plotly_white",
    height=500,
    showlegend=False
)
fig.show()
```

## Commodity Forward Curves {data-state="grid-medium"}

More complex due to storage costs and convenience yields:

::: {.incremental}

- High storage costs (electricity, natural gas)
- Convenience yield varies with supply/demand
- Upward or downward sloping
- Seasonal patterns (natural gas, corn)

**Bound:** $F \leq \mathrm{e}^{cT}S$ (may have little predictive power)
:::

## Crude Oil: Extreme Scenarios {data-state="grid-none"}

```{python}
#| label: fig-crude-forwards
#| fig-height: 500
#| echo: false

crude1 = df.loc[('CME_CL', '2020-04-20')]
crude2 = df.loc[('CME_CL', '2022-03-08')]

fig = make_subplots(
    rows=1, cols=2,
    subplot_titles=('April 20, 2020: "Negative Oil"', 'March 8, 2022: Ukraine Invasion'),
    horizontal_spacing=0.15
)

fig.add_trace(
    go.Scatter(x=crude1.index, y=crude1.values,
               mode='lines+markers',
               line=dict(width=3),
               hovertemplate='%{x|%b %Y}<br>Price: $%{y:.2f}<extra></extra>'),
    row=1, col=1
)

fig.add_trace(
    go.Scatter(x=crude2.index, y=crude2.values,
               mode='lines+markers',
               line=dict(width=3),
               hovertemplate='%{x|%b %Y}<br>Price: $%{y:.2f}<extra></extra>'),
    row=1, col=2
)

fig.update_xaxes(title_text="Maturity Date", row=1, col=1)
fig.update_xaxes(title_text="Maturity Date", row=1, col=2)
fig.update_yaxes(title_text="Futures Price ($)", row=1, col=1)
fig.update_layout(
    height=500,
    showlegend=False,
    template='plotly_white'
)
fig.show()
```

## Crude Oil Insights {data-state="grid-coarse"}

::::  {.columns}
::: {.column width="50%"}
**April 2020:**

- Coronavirus demand collapse
- Storage at Cushing full
- Extremely high storage costs
- Zero convenience yield
- Result: Steep upward slope
- Front month went negative!
:::

::: {.column width="50%"}
**March 2022:**

- Russian invasion of Ukraine
- Future supplies uncertain
- High convenience yield
- Result: Steep downward slope
- Premium for oil now vs. later
:::
::::

## Cyclical Commodities {data-state="grid-none"}

Natural gas and corn show seasonal patterns:

```{python}
#| label: fig-cyclical-forwards
#| fig-height: 500
#| echo: false

gas = df.loc[('CME_NG', '2018-06-08')]
corn = df.loc[('CME_C', '2018-06-08')]

fig = make_subplots(
    rows=1, cols=2,
    subplot_titles=('Natural Gas (2018-06-08)', 'Corn (2018-06-08)'),
    horizontal_spacing=0.15
)

fig.add_trace(
    go.Scatter(x=gas.index, y=gas.values,
               mode='lines+markers',
               line=dict(width=3),
               hovertemplate='%{x|%b %Y}<br>Price: %{y:.3f}<extra></extra>'),
    row=1, col=1
)

fig.add_trace(
    go.Scatter(x=corn.index, y=corn.values,
               mode='lines+markers',
               line=dict(width=3),
               hovertemplate='%{x|%b %Y}<br>Price: %{y:.2f}<extra></extra>'),
    row=1, col=2
)

fig.update_xaxes(title_text="Contract Date", row=1, col=1)
fig.update_xaxes(title_text="Contract Date", row=1, col=2)
fig.update_yaxes(title_text="Futures Price", row=1, col=1)
fig.update_layout(
    height=500,
    showlegend=False,
    template='plotly_white'
)
fig.show()
```

## Natural Gas Seasonality {data-state="grid-sparse"}

::: {.incremental}

**Summer to Winter (upward):** High storage costs

**Winter to Summer (downward):** High convenience yield (demand peak)

**Overall slope:** Depends on supply/demand conditions
:::

## Corn Seasonality {data-state="grid-medium"}

::: {.incremental}

**Pre-harvest (summer):** High convenience yield (scarcity)

**Post-harvest (fall):** High storage costs (silos full)

**Overall slope:** Varies with spot market conditions
:::

## Options on Futures {data-state="grid-medium"}

A derivative on a derivative!

::: {.incremental}

**Call:** Right to buy futures at strike

**Put:** Right to sell futures at strike

**Benefits:** Leverage, liquidity, avoids delivery/storage
:::

## Exercise of Futures Options {data-state="grid-coarse"}

When exercised, creates futures position + cash transfer:

::::  {.columns}
::: {.column width="50%"}
**Option Holder:**

- Call → Long futures position
- Put → Short futures position
- Marked to market at current futures price
- Receives cash = (Futures price - Strike)
:::

::: {.column width="50%"}
**Option Writer:**

- Call → Short futures position
- Put → Long futures position
- Marked to market at current futures price
- Pays cash = (Futures price - Strike)
:::
::::

## Futures Options Example {data-state="grid-medium"}

Buy call on corn futures, strike = $5.00, exercise at $5.50:

::: {.incremental}

**You (exerciser):**

- Long futures at $5.50 + receive $0.50 cash

**Option writer:**

- Short futures at $5.50 + pay $0.50 cash

**Result:** Both can immediately close futures positions
:::

## Summary: Key Takeaways {data-state="grid-medium"}

::: {.incremental}
1. **Futures = Obligations** for both parties (vs. options)

2. **Daily marking to market** virtually eliminates counterparty risk

3. **Leverage** through margin enables high returns/losses

4. **Spot-futures parity** is an arbitrage relationship: $F = \mathrm{e}^{(c-y)T}S$

5. **Forward curves** reveal cost of carry minus convenience yield

6. **Commodity curves** complex due to storage and seasonality

7. **Futures options** combine benefits of both derivatives
:::

## Next Steps {data-state="grid-coarse"}

Building on this foundation:

::: {.incremental}

- **Hedging with futures**: Optimal hedge ratios, basis risk
- **Futures pricing models**: Storage models, asset pricing theory
- **Spread trading**: Calendar spreads, inter-commodity spreads
- **Arbitrage strategies**: Cash-and-carry, reverse cash-and-carry
- **Real-world considerations**: Transaction costs, margin management, delivery options
:::
